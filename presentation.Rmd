---
output:
  ioslides_presentation:
    widescreen: true
    incremental: true
bibliography: references.bib
link-citations: true
urlcolor: blue
title: Statistical Analysis of the <br> Grit Scale Dataset
subtitle: Submitted to the Department of Statistics <br> of the Athens University of Economics and Business
author: Maximilian Schneider
date: "`r format(Sys.time(), '%d.%m.%Y')`"
---

<style>
.build > * {
    -webkit-transition: opacity 0ms ease-in-out;
    -webkit-transition-delay: 0ms;
    -moz-transition: opacity 0ms ease-in-out 0ms;
    -o-transition: opacity 0ms ease-in-out 0ms;
    transition: opacity 0ms ease-in-out 0ms;
}
slides > slide.title-slide {
    background-image: url('figures/background_title_page_1920x1080.jpg');
    background-size: 100% 100%;
}
slides > slide.dark {
    background-image: url('figures/background_title_page_1920x1080.jpg') !important;
    background-size: 100% 100% !important;
}
slides > slide.title-slide hgroup h1,
slides > slide.title-slide hgroup h2,
slides > slide.title-slide p,
slides > slide,
slides > slide hgroup h2 {
    color: black;
}
slides > slide.dark hgroup h2 {
    color: black;
    font-size: 72px;
    letter-spacing: 10;
}
div.footnotes {
    position: absolute;
    bottom: 0;
    margin-bottom: 10px;
    width: 80%;
    font-size: 0.6em;
}
table {
    caption-side: bottom
}
</style>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
<script>
$(document).ready(function() {
  $('slide:not(.backdrop):not(.title-slide)').append('<div class=\"footnotes\">');

  $('footnote').each(function(index) {
    var text  = $(this).html();
    var fnNum = (index+1).toString();
    $(this).html(fnNum.sup());

    var footnote   = fnNum + '. ' + text + '<br/>';
    var oldContent = $(this).parents('slide').children('div.footnotes').html();
    var newContent = oldContent + footnote;
    $(this).parents('slide').children('div.footnotes').html(newContent);
  });
});
</script>

```{r setup, include=FALSE}
# rmarkdown settings
knitr::opts_chunk$set(fig.align = "center", out.width = '80%', echo = FALSE, cache = FALSE,
                      message = FALSE, warning = FALSE)

# packages
library(data.table)
library(purrr)
library(magrittr)
library(ggplot2); theme_set(theme_bw())
library(mgcv)

# code
source("R/functions.R")
source("R/prepare-data.R")
source("R/application.R")
source("R/plots.R")
```

<!-- TODO

## Statistics

* REML is not suitable for model comparisons! Read wood chapter on model comparison
* Give frequencies of categories
* Consider cumulative frequencies for ordinal variables and the median
* Mention outlier are not so important because of n > 4000
  * Try `mvoutlier::uni.plot()`
* Try `sjPlot::tab_corr()`
* Model diagnostic: problematic: skewness of residuals
* Look at internally and externally studentized residuals
  * Maybe plot them against each other
  * Or plot the t-distribution with the values (https://online.stat.psu.edu/stat462/node/247/) (maybe histogram + theoretical distribution) (see data analysis notes)
* Outlier

## Presentation

* How long: 10min + 5min questions
* Don't forget figure titles
-->

# The Big Five <br> Personality Dimensions

## The Big Five personality dimensions<footnote>https://en.wikipedia.org/wiki/Big_Five_personality_traits</footnote>

<div class="notes">
> * Extraversion (outgoing -- solitary / energetic -- reserved)
> * Neuroticism (sensitive -- resilient / nervous -- confident)
> * Agreeableness (friendly -- critical / compassionate -- rational)
> * Conscientiousness (efficient -- extravagant / organized -- careless)
> * Openness to experience (inventive -- consistent / curious -- cautious)
</div>

* Extraversion
* Neuroticism
* Agreeableness
* Conscientiousness
* **Openness to experience**

# The Grid Scale Dataset

<div class="notes">
> * Online questionnaire data
> * Study: "Development and Validation of the Short Grit Scale"
> * Angela Duckworth and Patrick Quinn
> * International Personality Item Pool (IPIP), Demographic data, Technical information
</div>

## Eloquence score

<div class="notes">
> * Basis: List of 16 words, 3 unreal
> * "Mark all the words whose definitions you are sure to know."
> * Sum of correct answers
> * Assumption: No NAs
</div>

```{r plot-eloquence}
p1
```

## Openness score

<div class="notes">
> * Likert-type scale, Encoding: 0 (Disagree strongly) to 4 (Agree strongly), NA
> * Questions 2, 4 and 6 other way around, After transformation all items positively correlated
> * Score: sum of single items divided by four times the number of items answered
> * Possible scores: multiples of $\frac{1}{40}$ (all ten openness items completed), $\frac{1}{36}$ (nine Openness items completed), $\frac{1}{32}$ ...
</div>

```{r plot-openness}
p2
```

## Other variables

<div class="notes">
> * Scales: ratio, ratio, ordinal, rest: nominal
> * Error in race variable
> * Technical info as sanity check
> * 8 automatically collected technical information
</div>

```{r}
ggtable(dt_bigf, sort(vars_cat)[1:4])
```

## Other variables

```{r}
ggtable(dt_bigf, sort(vars_cat)[5:8])
```

## Other variables

```{r}
cowplot::plot_grid(
  ggtable(dt_bigf, sort(vars_cat)[9:10]),

  cowplot::plot_grid(
    ggplot(dt_bigf, aes(age)) +
      geom_histogram(color = "white", fill = "#606161", bins = 50) +
      geom_vline(xintercept = mean(dt_bigf$age, na.rm = TRUE)) +
      labs(x = paste0("Age, NA: ", sum(is.na(dt_bigf$age))), y = "Count") +
      xlim(0, 80),
    ggplot(dt_bigf, aes(familysize)) +
      geom_histogram(color = "white", fill = "#606161", bins = 50) +
      geom_vline(xintercept = mean(dt_bigf$familysize, na.rm = TRUE)) +
      labs(x = paste0("Family size, NA: ", sum(is.na(dt_bigf$familysize))), y = "Count") +
      scale_x_continuous(limits = c(0, 18), breaks = seq(0, 18, 6)),
    ncol = 1),
  ncol = 2)
```

## Missing data

* Full model (absolute): `r dt_bigf[, .N] - dt_bigf.fix[, .N]`
* Full model (relative): `r scales::percent((dt_bigf[, .N] - dt_bigf.fix[, .N]) / dt_bigf[, .N], 0.01)`
* Final model (absolute): `r dt_bigf[, .N] - summary(m.lam.fin)$n`
* Final model (relative): `r scales::percent((dt_bigf[, .N] - summary(m.lam.fin)$n) / dt_bigf[, .N], 0.01)`

## Pairwise associations with Openness

<div class="notes">
> * Consider some covariates as non-linear
> * Age starting at 13
> * Family size: number of kids of mother -- starting at 1, linear
</div>

```{r openness-continuous}
cowplot::plot_grid(p4, p3, p5, nrow = 3)
```

# Linear Regression Model for Openness

## Model selection

<div class="notes">
> * AIC: no theory $\rightarrow$ focus on prediction
> * Full enumeration $\rightarrow$ avoid step-wise procedures (i.e., arbitrary choices) and problems with collinearity: only variables which contain unique information will be used
> * No clear best model, see next slide
</div>

```{r aics}
res[1:5, .(AIC, Probability = scales::percent(probs, 0.01))] %>%
  knitr::kable(booktabs = TRUE,
               caption = "Top 5 models according to AIC and their probabilities to minimize the (estimated) information loss<footnote>Burnham, K. P.; Anderson, D. R. (2002), Model Selection and Multimodel Inference: A practical information-theoretic approach (2nd ed.), Springer-Verlag.</footnote>")
```

## A posteriori inclusion probabilities

<div class="notes">
> * Only urban and married have a probability lower than 50%
> * Model using all covariates with a post incl prob > 50% is the model with the lower AIC
> * Second best dropped voted
> * Third best dropped engnat
</div>


```{r post-inclusion-probs}
p6
```

## Model diagnostics and limitations

<div style="float: left; width: 50%;">
* Explained variance: `r scales::percent(summary(m.lam.fin)$dev.expl, 0.1)`
* $n =$ `r summary(m.lam.fin)$n`
* edf
* distribution of residuals
* Why we don't test for normality of residuals
</div>

<div style="float: right; width: 50%;">
* Missing covariates
* Number of observations?
* Online questionnaire data
</div>

## Statistical significance

<div class="notes">
> * So dumb
> * With enough observations everything is statistically significant
</div>

<div style="float: left; width: 50%;">
```{r}
dt_f <- anova(m.lam.fin) %$%
  cbind(c(pTerms.table[, "F"], s.table[, "F"]), c(pTerms.pv, s.table[, "p-value"]) * 11) %>%
  round(3) %>%
  as.data.table(keep.rownames = TRUE)
dt_f[, V2 := ifelse(V2 > 0.5, ">0.5", V2)]
dt_f[, V2 := ifelse(V2 == "0", "<0.001", V2)]
setnames(dt_f, c("Covariate", "F-statistic", "p-value"))

knitr::kable(dt_f[1:6,], booktabs = TRUE)
```
</div>

<div style="float: right; width: 50%;">
```{r}
knitr::kable(dt_f[7:11], booktabs = TRUE,
             caption = "Drop one F-tests with Bonferroni correction (approximations for smooth terms<footnote>Wood, S.N. (2017). Generalized Additive Models: An Introduction with R, Second Edition (2nd ed.). Chapman and Hall/CRC.</footnote>)")
```
</div>

## Coefficients

<div class="notes">
> * Do they make sense? / Are they as expected?
> * Reference class
</div>

```{r coefficients1}
p7.1
```

## Coefficients

<div class="notes">
> * Reference class
</div>

```{r coefficients2}
p7.2
```

## Smooth effects

<div class="notes">
> * Eloquence makes sense - is part of the definition of Openness
> * Age - concerning: in there search for a thing called "character" something consistent over time is desired
</div>

```{r smooths}
cowplot::plot_grid(p10.1, p10.2, ncol = 1)
```

# Appendix

## Sensitivity - REML

```{r}
p8
```

